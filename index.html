<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Entity Generator</title>
<style>
body{
    background:#111;
    color:#eee;
    font-family:monospace;
    padding:20px;
}
button{
    padding:10px 20px;
    background:#222;
    color:#fff;
    border:1px solid #555;
    cursor:pointer;
}
textarea{
    width:100%;
    height:400px;
    background:#000;
    color:#0f0;
    margin-top:20px;
    padding:10px;
}
select{
    padding:5px;
    margin-left:10px;
}
</style>
</head>
<body>

<h2>Random Entity Generator</h2>

<label>Level:
<select id="level">
<option value="1">Lv.1</option>
<option value="2">Lv.2</option>
<option value="3">Lv.3</option>
</select>
</label>

<button onclick="generateEntity()">Generate</button>

<textarea id="output" readonly></textarea>

<script>

const levelLimits = {
    1: 20000,
    2: 10000,
    3: 5000,
    4: 1000,
    5: 100
};

const statuses = ["Active", "Dormant", "Archived", "Sealed"];
const classifications = ["空間干渉型", "現象発生型", "物質変質型", "生物異常型"];

function randomFrom(arr){
    return arr[Math.floor(Math.random() * arr.length)];
}

function pad(num){
    return num.toString().padStart(4,'0');
}

function getUniqueNumber(){
    let used = JSON.parse(localStorage.getItem("cii_used_numbers") || "[]");

    let num;
    do {
        num = Math.floor(Math.random() * 9999) + 1;
    } while(used.includes(num));

    used.push(num);
    localStorage.setItem("cii_used_numbers", JSON.stringify(used));

    return pad(num);
}

function generateParagraph(baseText){
    let text = baseText;
    while(text.length < 1600){
        text += `
当該対象は自然発生的生成物と推定されておりますが、生成過程の直接観測には成功しておりません。
周辺環境への影響は段階的に拡張する傾向が見られ、局所的な心理的不安、空間認識の歪曲、
時間感覚の断絶など複合的干渉が報告されております。
物理的破壊や排除行為は禁止されており、観測・記録のみに限定されます。
CII規定FD-01およびFD-07に基づき、直接干渉は禁止されております。
`;
    }
    return text;
}

function generateEntity(){

    const level = document.getElementById("level").value;
    const fileNum = getUniqueNumber();
    const classification = randomFrom(classifications);
    const status = randomFrom(statuses);

    // Lv.3以上はII固定、それ以下はランダム
    const type = (level >= 3) ? "II" : (Math.random() > 0.3 ? "II" : "UI");

    const baseOverview = `
本対象は${classification}に分類される${type}であり、
複数地域において断続的観測がなされております。
発生条件は未確定ですが、環境的孤立状態または閉鎖的構造内での確認例が多く報告されております。
`;

    const baseRecord = `
初回観測は匿名政府経由報告に基づき登録されました。
観測機器において数値的異常は検出されない場合が多く、
主として視覚的・心理的干渉として記録されております。
`;

    const baseDamage = `
現時点での直接的死者報告は限定的ですが、
失踪・精神崩壊・長期入院等の二次被害が確認されております。
被害規模はLv.${level}基準に基づき分類されております。
`;

    const baseClassify = `
自然発生性が否定できないためEntityとして登録されました。
UI指定からIIへ昇格する可能性があり、
継続観測対象とされております。
`;

    const baseNote = `
本件は将来的にGIS指定対象へ移行する可能性があります。
研究部門への追加資料送付済。
`;

    const baseCore = (level >= 4) ? `
CORE緊急審議に付されました。
Lv.5職員の書類承認後、観測継続のみと決定。
` : `該当なし`;

    const overview = generateParagraph(baseOverview);
    const record = generateParagraph(baseRecord);
    const damage = generateParagraph(baseDamage);
    const classify = generateParagraph(baseClassify);
    const note = generateParagraph(baseNote);

    const output = `
CII/CL/File-${fileNum}
Classification: Entity-${fileNum} (${type})
ACCESS: Lv.${level}
Status: ${status}
─────
■ 概要
─────
${overview}
─────
■ 観測記録
─────
${record}
─────
■ 被害状況
─────
${damage}
─────
■ 分類経緯
─────
${classify}
─────
■ 補足
─────
${note}
─────
■ CORE審議履歴（該当時）
─────
${baseCore}
────────────────
`;

    document.getElementById("output").value = output;
}

</script>

</body>
</html>
